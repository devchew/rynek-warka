---
import LazyImage from './LazyImage';

export interface BlogPostProps {
  id: string;
  title: string;
  excerpt: string;
  date: Date;
  image: string;
  author: string;
  slug: string;
  category: string;
}

interface Props {
  post: BlogPostProps;
  featured?: boolean;
}

const { post, featured = false } = Astro.props;

// Format date: DD Month YYYY
const formatDate = (date: Date) => {
  return date.toLocaleDateString('pl-PL', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
  });
};

// Define category colors
const categoryColors = {
  "Kawiarnia": "bg-amber-100 text-amber-800",
  "Sztuka": "bg-purple-100 text-purple-800",
  "Wydarzenia": "bg-blue-100 text-blue-800",
  "Warsztaty": "bg-green-100 text-green-800",
  "Społeczność": "bg-rose-100 text-rose-800",
};

// Get category color or default
const getCategoryColor = (category: string) => {
  return categoryColors[category] || "bg-stone-100 text-stone-800";
};
---

{featured ? (
  <div class="relative group overflow-hidden rounded-xl shadow-md hover:shadow-xl transition-all duration-300 h-full">
    <a href={`/blog/${post.slug}`} class="block h-full">
      <div class="aspect-[16/9]">
        <LazyImage 
          src={post.image} 
          alt={post.title}
          className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
          width="100%"
          height="100%"
          client:visible
        />
      </div>
      <div class="absolute inset-0 bg-gradient-to-t from-stone-900 via-stone-900/50 to-transparent flex flex-col justify-end p-6">
        <span class={`inline-block px-3 py-1 rounded-full text-xs font-medium mb-3 ${getCategoryColor(post.category)}`}>
          {post.category}
        </span>
        <h3 class="text-2xl md:text-3xl font-playfair text-white mb-3 group-hover:text-amber-300 transition-colors">
          {post.title}
        </h3>
        <div class="flex items-center text-stone-300 text-sm">
          <span>{post.author}</span>
          <span class="mx-2">•</span>
          <time datetime={post.date.toISOString()}>{formatDate(post.date)}</time>
        </div>
      </div>
    </a>
  </div>
) : (
  <div class="bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 h-full flex flex-col">
    <a href={`/blog/${post.slug}`} class="block group">
      <div class="aspect-[16/9] overflow-hidden">
        <LazyImage 
          src={post.image} 
          alt={post.title}
          className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
          width="100%"
          height="100%"
          client:visible
        />
      </div>
    </a>
    <div class="p-5 flex-1 flex flex-col">
      <div class="flex items-center justify-between mb-3">
        <span class={`inline-block px-3 py-1 rounded-full text-xs font-medium ${getCategoryColor(post.category)}`}>
          {post.category}
        </span>
        <time datetime={post.date.toISOString()} class="text-xs text-stone-500">
          {formatDate(post.date)}
        </time>
      </div>
      <a href={`/blog/${post.slug}`} class="block group">
        <h3 class="text-xl font-playfair font-medium text-stone-800 mb-2 group-hover:text-amber-700 transition-colors">
          {post.title}
        </h3>
        <p class="text-stone-600 mb-4 line-clamp-2">{post.excerpt}</p>
      </a>
      <div class="mt-auto flex items-center">
        <span class="text-sm text-stone-500">{post.author}</span>
        <div class="ml-auto">
          <a 
            href={`/blog/${post.slug}`} 
            class="inline-flex items-center text-sm font-medium text-amber-700 hover:text-amber-600"
          >
            Czytaj więcej
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 transition-transform group-hover:translate-x-1" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
)}
